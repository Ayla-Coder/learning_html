<!DOCTYPE html>
<html lang="en-US">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Apply google sheets custom form</title>
    <base target="_top" />

  </head>
<body>
<p>hello world! I can't figure this out....
</p>
<body>
  <form>
    Text1: <input type="text" name="sampleText1" /><br />
    Text2: <input type="text" name="sampleText2" /><br />
    <select name="sampleDropdown1">
      <option value="sampleOption1">sample1</option>
      <option value="sampleOption2">sample2</option>
      <option value="sampleOption3">sample3</option>
    </select>
    File: <input type="file" name="sampleFiles" multiple /><br />
    <input
      type="submit"
      name="button"
      value="submit"
      onclick="run(this);return false;"
    />
  </form>
  <script src="https://cdn.jsdelivr.net/gh/tanaikech/HtmlFormObjectParserForGoogleAppsScript_js/htmlFormObjectParserForGoogleAppsScript_js.min.js"></script>
  <script>
    async function run(e) {
      const url = "https://script.google.com/macros/s/AKfycbw0YHW5hfvZSnQMoqny9qpZuznbw2tYk03NR6whjgYQlGU8R3mMtk5LLEqhv_fSJCMK/exec"; // Please set your Web Apps URL here.
      const obj = await ParseFormObjectForGAS(e.parentNode, null, null, true);
      fetch(url, { method: "POST", body: JSON.stringify(obj) })
        .then((res) => res.json())
        .then((res) => console.log(res));
    }
  </script>
</body>
</html>